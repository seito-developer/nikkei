# IDEとは
IDE(Integrated Development Environment)とは、開発に必要なツールを一つにまとめたソフトウェアです。
単にテキストやコードを書くだけのシンプルなソフトウェアのことはテキストエディアと呼びますが、IDEはそれに加えて多種多様な機能を有しており、それらを活用することで作業効率を何百倍にも加速させることができます！
プログラミングを行う上でIDEは必須と言っても過言ではありません。

# Cursorとは
CursorはIDEの一種で、2023年11月現在もっとも注目度が高いIDEといっても過言ではありません。
CursorはAnysphere社というスタートアップが開発するIDEで、その最大の特徴はなんといってもAI(ChatGPT)が標準搭載されていることです。
それまではIDEといえばマイクロソフト社のVisual Studio Code(以下VS Code)がデファクトスタンダードでしたが、Cursorの登場によりその地位は揺らぎつつあります。

AI搭載というと敷居が高そうに見えるかもしれませんが、そんなことはありませんし、操作性もよくほかのIDE同様に無料で簡単に使うことができます。
VS Codeを初めとした従来のIDEが持っている機能に加え、Cursorはとくに下記のような特徴を持っています。

1.ChatGPTが標準搭載されており、とてもスムーズに質問できる操作性
2.プロジェクトを横断的に分析・質問できるCODEBASE機能
3.AIがコーディングをサポートしてくれるCOPILOT機能（要有料プラン）

無料版だとChatGPTに質問できる回数に月額制限がある、COPILOT機能が使えない、などの制限はありますが、そうした縛りがあったとしても他のIDE以上の性能のため、導入しない理由はありません！

## プランによる機能の違い

| 項目 | Free | Pro | Business |
| --- | --- | --- | --- |
| 費用 | 無料 | 月額$20 | 月額$40 |
| ChatGPT-4 | 低速・50回/月 | 高速・200回/月 | 月間無制限 |

# セキュリティに問題はないの？
とくに会社支給のPCでCursorを使う場合や仕事でCursorを使う場合、セキュリティ的に大丈夫だろうか？と心配する方もいるかもしれません。
結論からいうと、お努めの会社のポリシーなどでこうしたAIツールの仕様が禁止されている場合、CursorのAI機能は使わない、またはVS Codeなどの従来のIDEを使うことをオススメします。
VS CodeはほぼCursorと同じ機能・同じUI画面なので、VS Codeだとしても以降の本書の説明はAI機能を除きほぼそのまま適用できます。

![イメージ図](images/cursor/vscode.png)

VS Codeのインストールは簡単で、公式サイトへアクセスすると閲覧者のOSによってダウンロードボタンが対応したOSのものに変わるので、それをクリックするだけです。

https://code.visualstudio.com/

公式サイトの説明によれば、Cursorは設定で「プライバシーモード」を有効にすることで、コードの情報はCursorを運営するAnysphere社のサーバーに保存されなくなります。（後述）
ただし、FreeまたはProプランの場合はそれでもChatGPTを開発するOpenAIは送信したプロンプトを30日間保持するとしています。
Businessプランの場合、Cursorは一切プロンプトデータを保存しないとしています。
ただし、そうはいってもAnySphere社やOpenAIを信頼するかどうかは個人の判断に委ねられます。

AI機能の有無によって学習効率や生産性は確実に何倍にも跳ね上がり周りと差がつくでしょうから、できることならAI機能が使えるような環境を作っておきたいところです。

# Cursorのインストール
まずは公式サイト（https://cursor.sh/）にいき、任意のOSのインストーラーをダウンロードしてください。
このWebサイトは自動でOSの種類を判別し、ユーザーのOSに合わせて一つだけダウンロードのボタンを表示してくれますので、それをクリックしましょう。

![イメージ図](images/cursor/cursor-setup-1.png)

するとMacの場合はzip、windowsの場合はexeファイルがダウンロードされるので、これをダブルクリックします。

![イメージ図](images/cursor/cursor-setup-2.png)

途中、下記のようにセキュリティの警告が表示されることがありますが、そのまま進めてください。

![イメージ図](images/cursor/cursor-setup-3.png)

インストール後、はじめにCursorを起動すると下記のような設定画面が表示されますので、任意のものを選択してください。
LanguageはAIの対応言語に関する設定です。日本語でやり取りをしたい場合は"Japanese"または"日本語"と入力します。
その他はデフォルトのままで問題ありません。設定を確認したら`Continue`をクリックします。

![イメージ図](images/cursor/cursor-setup-4.png)

VS Codeをインストールしている人の場合は、拡張機能を引き継ぐかどうか聞かれる画面が表示されるので`Use Exetnsions`をクリックします。
（なんと、CursorはVS Codeの拡張機能を1クリックでそのまま使うことができるのです！）

![イメージ図](images/cursor/cursor-setup-5.png)

続いてアカウントの登録・ログインを求められるので、初回は`Sign Up`を選択します。

![イメージ図](images/cursor/cursor-setup-6.png)

遷移先の画面でメールアドレスまたはGoogleかGitHubアカウントにて、アカウント登録を済ませましょう。

![イメージ図](images/cursor/cursor-setup-7.png)

アカウント登録を済ませると、自動でログインしCursorのデスクトップアプリに戻るためのダイアログが表示されます。

![イメージ図](images/cursor/cursor-setup-8.png)

これでインストールは完了です！下記のような画面が表示されていればCursorのセットアップは成功しています。
初回に表示されるこのタブウィンドウは閉じてしまって問題ありません。

![イメージ図](images/cursor/cursor-setup-9.png)

# Cursorの基本的な使い方
Cursorでコーディングを行うにはまず、プロジェクト（※）があるフォルダを開く必要があります。
プロジェクトを開くには、左上の`File`メニューから`Open Folder`を選択し、プロジェクトがあるフォルダを選択します。これでCursorにプロジェクトが読み込まれます。

※1つのアプリケーションに関するhtmlやjsなどのファイルがまとまって格納されたディレクトリのことをプロジェクトと呼びます。

![イメージ図](images/cursor/cursor-folder-open.png)

ファイルを直接開くこともできますが、フォルダごと開いてプロジェクトをCursorに認識させることで、プロジェクト内の検索など様々な恩恵を受けられます。そのため、基本的にプロジェクト単位で開くことをおすすめします。

# 画面とメニューの説明

![イメージ図](images/cursor/cursor-screen-with-frame.png)
![イメージ図](images/cursor/cursor-screen2-with-frame.png)
![イメージ図](images/cursor/cursor-screen3-with-frame.png)

- a.主要なメニューがあります。一番右の矢印アイコンをクリックすると全メニューが表示され、ピンのアイコンをクリックすると目立つ位置にとどめておくことができます。（導入した拡張機能次第でこのメニューは増えたりします）
  - Explorer（shift+cmd+E/shift+alt+E）：プロジェクト内全体のファイルを一覧化
  - Search(shift+cmd+F/shift+alt+F)：プロジェクト内全体で検索
  - Source Control（shift+cmd+G/shift+alt+G）：Gitが扱える
  - Extentions（shift+cmd+X/shift+alt+X）：拡張機能を探す　... など
- b.aで選んだメニューが表示される領域。この画像はエクスプローラーの表示
- c.現在アクティブ（選択中の意味）のファイルの中身を表示
- d.コマンドラインなどが使える領域
  - TERMINAL: コマンドラインが使える
  - PROBLEMS: プロジェクト内のコードにエラー等がある場合、ファイル名や行数の情報と共にここに表示される
- e.AIやそれに関わる設定領域
 - CHAT: AIとのチャット領域
 - MORE:
   - RULES FOR AI: AIとの会話で使う言語。「Always respond in 言語」の”言語”の部分を変えることで変更可能
   - COPILOT++: enabledでAIによるペアプログラミングモードをオンにする（要有料プラン）
   - CODEBASE INDEXING: CODEBASE機能（プロジェクトのファイル全体について横断的に分析・質問できる機能）を使用するためにファイル全体の読み込みを行う
- f.画面を分割・表示するメニュー
- g.設定

なお、各メニューの表示・非表示はグローバルメニューの`View -> Appearance`内で行えます。

# 設定

## 主要な設定
Cursorの主要な設定はグローバルメニューの`Cursor -> Preferences -> Settings`またはショートカットキー(cmd+,/ctrl+)で変更できます。

![イメージ図](images/cursor/cursor-setting.png)

ほとんどの設定はデフォルトのままで問題ありませんが、主に下記の設定は把握しておくと良いでしょう。

- Commonly Used
  - Files: Auto Save
    - デフォルト: `off`
    - 推奨: `afterDelay`
    - 説明: ファイルに変更を加えたときに自動で保存する機能です。`off`だと手動で毎回保存する必要があるため、保存忘れによる変更の消失を防ぐことができます。
  - Editor: Font Size
    - デフォルト: 12
    - 推奨: 任意の値
    - 説明: エディターのフォントを変更できます。
  - Editor: Tab Size
    - デフォルト: 4
    - 推奨: 4
    - 説明: インデントで使うタブの幅を変更できます。タブの幅は4または2が一般的です。自分がリーダーのプロジェクトはさておき、既存のプロジェクトに合わせるのであれば、そのプロジェクトのコーディング規約に従って変更しましょう。

## アカウント設定
Cursorのアカウント設定は画面右上の歯車アイコン（先程の画面図の`g`）をクリックすると開けます。

![イメージ図](images/cursor/cursor-setting2.png)

- Account
 - Log Out: 現在ログイン中のアカウントからログアウトします。
 - Manage: アカウントの管理画面（Webページ）を開きます。ここからプランや支払い方法の変更・停止などができます。
- Privacy mode
 - デフォルト: disabled
 - 推奨: enabled
 - 説明: AIに質問する際に、質問内容をAnySphere社のサーバーに送信するかどうかを設定できます。`enabled`にすると、質問内容はAnySphere社のサーバーに送信されず、OpenAIのサーバーにのみ送信されます。ただし、OpenAIは送信したプロンプトを30日間保持します。`disabled`にすると、質問内容はAnySphere社のサーバーに送信されますが、データを収集することでAIの精度が改善されることがあります。

# 基本的な機能

## クイック・オープン
Cursorでは同じプロジェクト内のファイルであれば、クイック・オープンからファイル名の一部を少し入力するだけで素早く開くことができます。
クイック・オープンは画面左上の`File`メニューから`Quick Open`を選択するか、ショートカットキー(cmd+P/ctrl+P)で開くことができます。

![イメージ図](images/cursor/cursor-quick-open.png)

## Command Pallette(コマンドパレット)
コマンドパレットを開くと、入力欄にコマンド名の一部を少し入力するだけで素早くCursorの機能を素早く実行することができます。
例えば後述する`Format Document`機能はコマンドパレットから`Format Document`と入力することで実行できます。実際は命令文すべてを入力する前に候補が表示されるので、それを選択するだけ（エンターキー）で実行できます。

コマンドパレットは画面左上の`View`メニューから`Command Pallette`を選択するか、ショートカットキー(cmd+shift+P/ctrl+shift+P)で開くことができます。

![イメージ図](images/cursor/cursor-command-pallette.png)

## コード補助・スニペット
Curosorはコード補助機能を標準で備えているため、楽にコードを書くことができます。
単純にタイピング数が減らせることでスピードアップが図れるほか、タイピングミスを避けることができるため、コードの品質も向上させることができます。

### 使用例:HTML
html:5と入力しエンターキーを押すと、下記のようなHTMLの雛形が展開されます。
![イメージ図](images/cursor/cursor-assist-html-1.png)
![イメージ図](images/cursor/cursor-assist-html-2.png)

そのほかにも、`タグ名`を入力→エンターキー、`タグ名 + セレクタ名`を入力→エンターキー、などとすることで、タグやセレクタを展開し閉じタグまで自動で入力してくれます。
![イメージ図](images/cursor/cursor-assist-html2-1.png)
![イメージ図](images/cursor/cursor-assist-html2-2.png)

### 使用例:CSS
CSSでは、`プロパティ名の一部 + 値の一部`を入力→エンターキーで、プロパティ名と値を自動で入力してくれます。
CSSの補完でとくにすごいのが、プロパティ名や値の単位をすべて入力する必要がなく、”なんとなく”の略称で補完されるところです。

例えば`display: block;`なら`db`、`margin-top: 10px;`なら`mt10`、`font-size: 16px;`なら`fs16`といった具合です。
![イメージ図](images/cursor/cursor-assist-css-1.png)
![イメージ図](images/cursor/cursor-assist-css-2.png)

### 使用例:JS
JSでは`const`や`for`など、キーワードの一部を入力するだけで、そのキーワードに関するコードを自動で入力してくれます。
![イメージ図](images/cursor/cursor-assist-js-1.png)
![イメージ図](images/cursor/cursor-assist-js-2.png)

## 全角・半角を見分ける
全角入力は文字列以外で使うとエラーの原因になります。とくにスペースは全角なのか半角なのか見分けが難しいですが、Cursorでは下記のように全角スペースは黄色くハイライトされるため、全角・半角を見分けることができます。

![イメージ図](images/cursor/cursor-space.png)

## Compare(ファイル比較)
何らかの教材を使いお手本となるコードを書いたとき、そのコードと自分のコードを比較することで、自分のコードの問題点を発見することができます。
Cursorでは下記のように、2つのファイルを比較することができます。

1. 自分が書いたコードのファイルを開いておく（アクティブ状態）
2. 比較したいコードをクリップボードにコピー
3. Cursorでコマンドパレットを開き、`Compare`と入力し、`Compare Active File with Clipboard`を選択

![イメージ図](images/cursor/cursor-compare-1.png)

比較時は下記のように、左側に自分のコード、右側にクリップボードにコピーしたのコードが表示されます。
差分がある箇所のみハイライトされるため、問題点を素早く発見することができます。

![イメージ図](images/cursor/cursor-compare-2.png)


# 主要なAI機能

## AIへ質問する
Cursorに標準搭載されたAIと会話することができます。中身はChatGPTなので、精度やできること自体はChatGPTとさほど変わりません。
基本的には右側のチャット入力画面に質問を入力し、エンターキーを押すだけです。（cmd+Y/alt+Yで素早くチャット入力画面にカーソルを移動できる）

![イメージ図](images/cursor/cursor-ai-assist1.png)

また、質問したい箇所をハイライトし、ショートカットキー（shift+cmd+L/shift+alt+L）を入力すると、自動でチャット入力画面にハイライトした部分がペーストされるので、わざわざコピー＆ペーストする手間が省けます。

![イメージ図](images/cursor/cursor-ai-assist2.png)

コマンドライン領域でも質問することができます。
先述の操作同様、ハイライトしたらショートカットキー（shift+cmd+L/shift+alt+L）でチャット入力画面にペーストできるほか、もしエラーログが発生している場合にはカーソルを乗せると表示される「Debug with AI」ボタンを押すと、該当箇所がペーストされるだけでなく「このエラーを解決してほしい」というようなプロンプトとセットで送信まで行われるため、AIによる解決を素早く試すことができます。

![イメージ図](images/cursor/cursor-ai-assist3.png)

## エラーの検知+AIによる解決
Cursorでは使われていない変数や関数名はグレーでハイライトされるため、これを利用して不要なコードを素早く見抜くことができます。
![イメージ図](images/cursor/cursor-never-used.png)

また問題になりそうな部分は波線でハイライトされるため、エラーを素早く発見することができます。
英文ですが、波線にカーソルを当てるとエラーメッセージも出してくれるので、これを解決の手がかかりにすることができます。

![イメージ図](images/cursor/cursor-ai-fix-1.png)

このとき、Cursorではエラーを検知するだけでなくそのまま該当箇所をAIに質問することができます。
使い方は簡単で、波線にカーソルを当てたままショートカットキー（shift+cmd+E/shift+ctrl+E）か、「AI Fix in Chat」ボタンをクリックするだけです。
するとエラー文とそれの解決を求めるプロンプトが画面右側のAIチャット領域に自動入力・送信され、下記のように返答を受け取ることができます。

![イメージ図](images/cursor/cursor-ai-fix-2.png)

## AIによるコード編集
任意の部分をハイライトし、Editボタン（またはショートカットキーcmd+K/alt+K）を押すと、AIによるコード編集を行うことができます。
これはエラーの解決というより、コードの書き方の変更や改善をAIに相談するというものです。

例えば下記の例では、JSのif文が書かれた箇所を似たような構文であるSwitch文（意味は同じ）に書き直してもらう操作を行っています。

![イメージ図](images/cursor/cursor-ai-assist-edit1.png)

元のコードは赤、提案されたコードは緑でハイライトされます。この状態で提案されたコードを良しとするならcmd+Y/shit+Yを入力すると緑の提案されたコードが、却下する場合はcmd+N/shit+Nを入力すると赤の元のコードが採用されます。

![イメージ図](images/cursor/cursor-ai-assist-edit2.png)

## COPILOT
Copilotとは副操縦士の意味で、AIがコーディングをサポートしてくれる機能です。
前後のコードから開発者の意図を推測し、コードを自動生成してくれます。

使い方は任意の場所にカーソルをあわせて、ショートカットキー（option+エンター/alt+エンター）を押します。
このとき、AIによるコード生成に若干の時間がかかりますが、その間option/altキーは押したままにします。
提案されたコードを採用する場合はもう一度エンターキーを押し、却下する場合はoption/altキーを離します。

例えば下記の例は現在の時刻に合わせて挨拶文を生成するJavaScriptの関数のコードです。

![イメージ図](images/cursor/cursor-copilot-1.png)

ここまでは私が自分でコーディングしました。
このプログラムはかいつまんで説明すると「0~10時なら挨拶を"Good morning"にする」という命令だけ書かれています。
ここでCursorのCOPILOT機能を使ってみます。

![イメージ図](images/cursor/cursor-copilot-2.png)

すると「18時までなら挨拶を"Good afternoon"にする」「それ以外の時間は挨拶を"Good evening"にする」という意味のコードが自動生成されました。
前後のコードから私の意図を推測してくたのです！

```
【コラム】GitHub Copilot
Copilotの類似のサービスとして、GitHub Copilotという拡張機能があります。
正直、執筆時点(2023/11)ではGitHub Copilotの方が使いやすいのですが、そちらを使う場合はまた別途有料プランに入る必要があります。（月額$10~）
Cursorはまだベータ版ですが、今後もっと使いやすく、賢くなっていくことでしょう。
```

# 拡張機能
CursorおよびVS Codeは便利な拡張機能を多数提供しています。デフォルトの状態ではなく、効率を劇的に上げるためにぜひこうしたものを取り入れて使い倒していきましょう。
拡張機能をインストール・利用するたには、左メニューの`Extensions`をクリックします。
RECOMMENDED（おすすめ一覧）から任意のものを選ぶか、検索ボックスから拡張機能名で検索・クリックし、`install`をクリックします。
インストール完了後は`Enable/Disable`でオン／オフが切り替えられます。

![イメージ図](images/cursor/cursor-extensions.png)

ここでは、特におすすめの拡張機能を紹介します。

## Live Server
![ロゴ](images/cursor/extension-live-server.png)

ローカルサーバーを立ち上げて、HTMLやCSSの変更をリアルタイムに反映してくれる拡張機能です。
インストール後は画面右下の「Go Live」をクリックするとローカルサーバーが立ち上がります。

![イメージ図](images/cursor/live-server-image.png)

## Code Spell Checker
![ロゴ](images/cursor/extension-spell-checker.png)

英語のスペルミスを指摘してくれる拡張機能です。例えば”配列”という意味の英単語`array`ですが、`aray`などとスペルミスしてしまった場合に、波線で指摘してくれます。

## Prettier - Code formatter
![ロゴ](images/cursor/extension-prettier.png)

コードのフォーマット（インデントや改行、クォーテーションなど）を統一したスタイルで整えてくれる拡張機能です。
インストール後は、クイックメニューから`Format Document`を選択すると、フォーマットが整えられます。
どのようなルールでカスタマイズするかは設定で変更できますが、デフォルトのままでも十分使えます。

## XXX snippets
スニペットとは直訳すると「断片」という意味ですが、要するによく使うコードのまとまりを数語のショートカットキーで呼び出せるようにしたものです。
HTML, CSS, JSなどの基本的なプログラミング言語のスニペットは標準である程度入っているためあまり必要性はないかもしれませんが、皆さんが今後別の言語やフレームワークを使った開発を行う場合は、その言語やフレームワークに対応したスニペットをインストールすることをおすすめします。
例えば、CSSのフレームワークであるBootstrapのスニペットなら「Bootstrap v4 Snippets」、フレームワークであるReactのスニペットなら「ES7+ React/Redux/React-Native snippets」などがあります。

![イメージ図](images/cursor/extension-snippets.png)

## HTMLHint
![ロゴ](images/cursor/extension-htmlhint.png)

HTMLのコードをチェックし改善点を示してくれる拡張機能です。例えばタグの閉じ忘れや、不要なタグなどを指摘してくれます。
※似たような名前の拡張機能が複数ありますが、このアイコンのもの以外は更新が止まっているなどの理由で非推奨とされています。ご注意ください。

## GitHub Copilot
![ロゴ](images/cursor/extension-copilot.png)

AIがコーディングをサポートしてくれる拡張機能。有料プランに加入する必要があります。