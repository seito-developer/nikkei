# エラーや不具合の解決法
プログラミングをしていると頻繁にエラーや原因不明の不具合に遭遇します。コーディングよりもそうした解決に割いている時間のほうが多いと話すエンジニアもいるくらいです。
しかしこうしたエラーや原因不明の事象に関して、詳しく解説している文書はあまり多くないかもしれません。
そこでこのセクションでは、メジャーなエラーや原因不明の事象に対し、解決策やどんな思考プロセスで解決していくのかを明確に言語化し、皆さんの学習に貢献したいと思います。

## 何がわからないのかを特定する
エラーや不具合を解決する際、まず「自分が何をどの程度わからないのか」を把握することから始めることが重要です。
なぜならプログラミングとは「コンピューターとコミュニケーションをとること」であり、人間のように知性や意志を持たないコンピューターには、曇りのない正確な指示を与える必要があるからです。

例えるなら、取引先に送るお歳暮をECサイトで購入しようと思ったとき、汲み取る力のある部下に指示するのであれば「ちょうど良さそうなお歳暮をECサイトで購入しておいて！」とだけ伝えれば購入まで実施してくれるかもしれません。
しかしコンピューターに指示する場合は「予算がいくらか、どこのサイトで購入するのか、いつまでに実施の必要があるか、...etc」など具体的に言語化しないと伝わりません。
これはGoogle検索やAIツールに尋ねる場合も同じで、具体的なワードを入力したり、何に自分が困っているのかを明確に伝えないと、期待する結果を得ることができません。

開発者で作家のフィリップ・G・アーマー氏による「無知の5段階のレベル（The Five Orders of Ignorance）」という論文がありますが、この考えによれば開発者がコーディング中に「わからない」と感じるシチュエーションは次の5つの段階に分類できます。

5. 自分が今どのわからない段階にいるのか、わからない
4. 何がわからないのかをわかるようにするプロセス(術)が、わからない
3. 何がわからないのか、わかっていない
2. 何がわからないのか、わかっている
1. わかっている

![Alt text](<../Chapter 1.プログラミングの学び方/images/The Five Orders of Ignorance.png>)

例えば、皆さんがあるWebページをプログラムして作ったとして、ブラウザで表示しようとしたところ、まったく表示されないという状態に陥ったとします...

---

### Level 5. 自分が今どのわからない段階にいるのか、わからない
「わからない」に段階があることを知らず、いま自分がどの程度わかっていないのかさえもわからない状態を意味します。
この状態の方は、Webページが表示されない状況をそれ以上分解できません。もし誰かに質問するとしたら「Webページが表示されない。助けて！」と言うでしょう。しかしこれでは抽象的すぎて誰も回答ができません。

### Level 4. 何がわからないのかをわかるようにするプロセス(術)が、わからない
「わからない」ことをわかるようにするための術を知らない状態を意味します。
この状態の方は、Level 5と違って自分が今どの程度わかっていない状態かは認識できていますが、Webページが表示されない状態を解決するための方法を知りません。とれる選択肢としては「知ってそうな人に聞く」程度でしょう。

### Level 3. 何がわからないのか、わかっていない
何がわからないのかを言語化出来ない状態を意味します。
この状態の方は、Level 4と違ってWebページが表示されない原因を探るためにGoogle検索やChatGPTに質問する、といった有効な術は持っています。しかしわからないことを言語化出来ないので、最適なワードで検索・質問ができません。
ただ術は持っているので、精度が低い分時間はかかるでしょうが、いずれ解決できる可能性があります。

### Level 2. 分からないことが分かっている
何がわからないのかは言語化できる状態を意味します。この状態の方は、Level 3と違ってWebページが表示されない原因はわかっています。
例えば、HTMLやCSSなどのソースコードには問題がなく、サーバー側に何らかの原因がある、しかし自分がその辺の知識がない...といったところまであたりがついています。
ここまでわかっていれば、制度の高いワードで検索したり、的確な質問をすることで最短で解決できるでしょう。

### Level 1. 全部分かっている
わからないことがない状態を意味します。Webページが表示されない状態も、「ああ、きっとサーバー側の設定を間違えたんだな。診てみよう」といった具合に解決まで迷わず進むことができます。

---

このように、まずは自分がどの段階にいるのかを把握することが重要です。
今日このパートを読んだことで皆さんは「わからない」に段階があることを学びましたので、少なくともLevel 5からは脱出できるはずです。
問題はLevel 4~3の状態を減らし、わからないにしても極力Level 2の状態を目指すことです。
Chapter 1にはそれを目指すための方法をふんだんに盛り込んだつもりです。プログラミング学習中に行き詰まりを感じたら、ぜひこのパートを読み返してみてください。

## コンピューターとのコミュニケーションには100%の精度が必要
人間との会話は100%の精度でなくても問題ありませんが、プログラミングをはじめとするコンピューターとの会話は100%の精度でなければなりません。
どういうことかいうと、人間との会話は「ある程度の誤差を許容してくれる」のに対して、コンピューターとの会話は「誤差を許容してくれない」のです。

例えばあなたがLINEで友人にランチの誘いをすべく、「今度の日曜日は時間ある？ランチに逝こう！」と送ったとします。この「逝こう」は「行こう」の変換ミスですが、おそらくほとんどの方に意味は伝わると思います。
しかしコンピューターとの対話はそうはいきません。
例えば下記のようなコードがあったとします。
    
```js
<?php
echo "Hello World";
?>
```

これはPHPという言語のコードで、"Hello World"という文字列を出力するという意味です。このとき一文字でも間違いがあればこのコードはエラーとなり、まったく動作しません。  
`?php`の部分のハテナマークを入力せず`?php`と入力する、単語の間の半角スペースを入力せず`echo"Hello World";`と入力する、セミコロン`;`を入力し忘れる...そんなわずか1文字のミスで、まるごと動かなくなります。

とくに初めの内はこの辺りのミスを許容してしまう学習者の方が少なくありません。

- 全角と半角の入力間違え
- スペースの有無
- インデントの有無
- 英語のスペルミス
- その他タイピングミス

こうした部分は回避し、常に丁寧にコードを書くことを心がけましょう。
...とはいえ、そう聞くと「そんな細かいところまで気をつけていたらあまりに大変すぎる！」と思うかもしれません。
しかしご安心ください。もちろん、これを楽に解決できる方法があります。

## コンピューターで楽をしよう
人間は細かな作業やルーティンが苦手です。先のような作業を手動で行うなら、どうしたってどこかでヒューマンエラーが発生します。
だからこそ、こうした作業はコンピューターに任せてしまいましょう。具体的な一例を示すと下記のような具合です。

- ケース 1
  - NG) 教材に記載されているコードを手動でタイピングする
  - OK) コピー＆ペースト（Windows: ctrl+C / ctrl+V, macOS: cmd+C / cmd+V）を使う
- ケース 2
  - NG) 1から100まで自分のちからでコードを書く
  - OK) IDEの補完機能やスニペットツールを使う
- ケース 3
  - NG) 全角・半角の違いやスペルミスなどを目視で確認する
  - OK) IDEの設定や拡張機能を使って自動チェックする

このように、コンピューターに任せられることはなるべく任せるようにしましょう。そうすることで、ヒューマンエラーを減らし本来集中すべき学習分野に皆さんのリソースを投下するほうが有意義です。  
なお、ここでいうIDEとはコードを書くためのソフトウェアのことですが、これの具体的な概要や使い方についてはChapter 3.2や4.2で解説します。

※IDEの補完機能を使ってコーディングする例。for文という3行からなるコードをわずか3文字入力するだけで展開している。
![Alt text](<../Chapter 1.プログラミングの学び方/images/cursor-assist-js-1.png>) 
![Alt text](<../Chapter 1.プログラミングの学び方/images/cursor-assist-js-2.png>)

## 100%の再現度を目指す
書籍なり動画なり、なんらかの教材を参考にプログラミングを学習する際におすすめしたいのが、まず __少なくとも1週目は再現度100%を目指すこと__ です。
どういうことか、本書のChapter 6でつくるおみくじアプリの解説の一部から抜粋し、具体例を示してみましょう。

---

... 中略 ...

まずはフォルダ`omikuji`をつくり、その中にHTMLファイルや画像を保存するためのフォルダを作っていきます。

```
/omikuji
├── index.html
├── style.css
├── script.js
└── /images
```

... 中略 ...

つづいてHTMLをコーディングしましょう！ `index.html` に下記の要素を記述します。

```html
1 <!DOCTYPE html>
2 <html lang="ja">
... 以下略 ...
```

---

おみくじアプリの例では、こんな具合に各種フォルダやファイルを用意し、HTMLやJavaScriptを書いていきます。
このとき、すべてを完全再現します。例えばフォルダ名は絶対に`omikuji`とし、フォルダ構成は先の例にならい順序も変えず、`index.html`の中身もコードはもちろん、インデントや空白行までそろえます。

学習者の立場としては、アレンジを加えたいという気持ちもあるでしょう。例えばフォルダ名を`omikuji`ではなく`omikuji-app`にしたい、見た目の装飾をもっと派手にしたい、などなど...。
しかし、初心者の内はそうしたアレンジが __問題ない範囲のプログラムなのか、不具合を誘発するものなのかを判断することが出来ません。__
それがないまま独自のコーディングを進めてしまうと、いざ不具合が起きた際に原因の切り分け困難になります。

それよりも、まず一周目は完全再現を目指すのです。そうすることで、もし不具合が出た際には原因を「完全再現できていないことが原因＝タイピングミスやどこかに教材と異なるコードの書き間違いがある」と判断できます。
また一度完全再現した後でアレンジを加えるなら、仮にうまく行かずとも、また一旦完全再現したところまでもとに戻すことで、原因の切り分けが容易になります。

プログラミングは日本で普通に暮らしている分には普段使わないような英語や記号を頻繁に利用するため、タイピングミスによるエラーは初学者のうちは非常に多いです。
本書のように、プログラミング教材はソースコードを公開・ダウンロードできるようなものが多いため、そのような場合にはぜひ積極的に活用し、コピー＆ペーストや自分が書いたコードと比較するようにしましょう。
Chapter 4.2で、IDEの機能で2つのコードを比較し差分を即座に発見する方法を解説していますので、こちらもぜひ参考にしてください。

---

【コラム】
技術文書を読んでいると、多くのサンプルコードにおいて全角や日本語が使われていないことに気づくでしょう。
プログラミングの世界においてはファイル名やコードの中身において、半角英数字で記述することが一般的です。
ここから逸脱すると予期せぬ不具合の原因になることが多いため、使っていい箇所とそうでない箇所の判別ができないうちは、半角英数字の仕様を心がけることをおすすめします。
例外として、文字列やコメントを扱う際には日本語が使えます。(Chapter 3.4, 3.5, 5.2参照）

---

## バージョン管理システムを使う
バージョン管理システムとは、更新履歴ごとデータのバックアップをとることができるシステムで、Chapter 4.2で解説するGitがその代表例です。
Gitは主に複数人・非同期でチーム開発する文脈でその有用性を語られがちですが、エラーなどの不具合解決をする際にもとても有効です。

というのも、例えば5日間毎日コーディングを行っていたとして、Gitを使うと毎日その日更新した分のデータを履歴とともに保存することができます。
コードを書いていて最終日にエラーがあることがわかり、その原因が3日目の更新にあったとしたら、もしGitを使っていない場合は、最悪3日目までのデータに戻してやり直す必要があります。しかしGitがあれば、3日目の更新箇所をピンポイントで探し出し、その箇所だけ修正するといったことも可能です。

![Alt text](<../Chapter 1.プログラミングの学び方/images/git-error-solution.png>)

Gitを導入することで、簡単にやり直す、一部もとに戻す、といったことが可能になります。これはエラーの解決においても大きなメリットとなります。

## エラーメッセージを読むテクニック
エラーが発生した場合、開発者ツールのコンソール画面やコマンドライン、Webページ上でエラーのメッセージやログを確認することができます。

これらの文言は英語、専門用語、記号などで構成されているため、初学者にとっては難解なように見えます。
しかし、エラーメッセージには読み方があり、コツがあります。また使われている英語も、単語は専門用語が使われている分難解に感じるかもしれませんが、英文法自体は至極単純で殆どの場合は中学で習う基本５文型の知識で読解できます。
エラーメッセージは不具合を解決するための情報が詰まっているため、絶対に確認するようにしましょう！

例えば下記はJavaScriptのエラーですが、どのプログラミング言語もある程度は共通した特徴があるため、ポイントを抑えておくことで理解までのスピードが大きく変わります。
![Alt text](<../Chapter 1.プログラミングの学び方/images/error-1.png>)
![Alt text](<../Chapter 1.プログラミングの学び方/images/error-2.png>)

1. エラーの種類: エラーの種類を表します。これにはいくつかパターンがあるので、エラーの種類からある程度原因を推測することができます。
2. エラーの内容: エラーの内容が
3. エラーの発生箇所: "ファイル名:行数"でエラーの原因となった部分を表します。この例ではmain.jsというファイルの18行目が原因であることを表しています。

エラーの種類は、主に下記のようなものがあります。
- ReferenceError: 存在しない変数が参照されたことを意味します。
- SyntaxError: 構文が間違っていることを意味します。間違った書き方をしていることが原因です。
- TypeError: 例えば数値を期待しているところに文字列が入っているなど、型が違うことが原因のエラーです。

また、エラーメッセージをGoogle検索にかけると、同じエラーに遭遇した人の解決策が示されたWebページが見つかることがあります。
その際は1と3の余計な情報を省き、2のエラーの内容をコピーして検索すると、期待する情報ヒットしやすい傾向にあります。
またChatGPTにまるごと聞くことも可能です。Chapter 1.6で使い方を解説していますので、ぜひこちらも参照ください。

ちなみに、この他通信時に発生するレスポンスコードの番号からエラーの種類を推測することもできます。こちらに関してはChapter 2.5、4.1で詳しく解説します。

---

【コラム】
この他にも、エラーの種類には様々な種類があります。下記はJSに関しての資料ですが、もっと詳しく知りたい方は下記は是非参考にしてみてください。

JavaScript エラーリファレンス | MDN web docs
https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Errors

---

## その他不具合の原因となりやすいもの
ここまではエラーについての解決方法を解説してきましたが、エラー以外にも不具合の原因となりやすいものがあります。
期待通りに動作していないのにエラーメッセージが表示されないということは、コード自体に問題はありません。原因はコードの外...PCやソフトウェアに問題がある可能性があります。
ここでは、そうした不具合の原因となりやすいものを紹介します。

1. 参照している情報が異なる
2. ファイルを読み込んでいない
3. ソフトウェアやモジュールに問題がある
4. PC自体に問題がある

### 1.参照している情報が異なる
画面やファイルなど、そもそも参照している情報が異なる、というケースです。
ありがちなのが、複数のタブやファイルを開きすぎてどれがどれだかわからなくなっている場合です。
例えば、デスクトップにあるファイル`index.html`を修正してブラウザ表示させてみたが一向に直らない！という場合に、実は同じ名前の別ディレクトリにあるファイルをずっと修正していた...ということがありえます。

### 2.ファイルを読み込んでいない
例えばJavaScriptやCSSをWebブラウザ上で実行する場合、HTMLファイルに読み込ませる必要があります。
読み込みができていない場合、当然ながらJavaScriptやCSSはエラーを出すことなく実行されません。

### 3.ソフトウェアやモジュールに問題がある
使用しているソフトウェアやモジュールに問題がある場合もあります。（モジュールについてはChapter 2.8, 7.3で解説します）
例えばソフトウェアのバージョンとOSのバージョンが合っていない、不具合が残っている、使用しているモジュールのバージョンの組み合わせが合っていない、などが考えられます。

このような場合には、最新版へのアップデート、アンインストール／再インストールを試みる、などの対応が有効です。
また使用しているバージョンが逆に新しすぎてアップデートしたら不具合が発生した、という場合にはダウングレードすることも有効な場合があります。

### 4.PC自体に問題がある
ソースコードやソフトウェアではなく、皆さんがお使いのPC自体に問題がある場合もあります。
たとえば、PCのメモリ不足でプログラムが実行できない場合がありますが、この場合は短期的にはPCの再起動にて、長期的にはメモリの増設やより多くメモリを積んだ高スペックのPCに買い替えるなどの措置が検討できます。

あるいはOSやCPUのバージョンが対応していないことによる不具合があるかもしれません。実際、Apple社が新しいCPUとしてM1チップを発表した2020年~2022年頃には、これに対応できていないソフトウェアが多くの不具合を誘発しました。

また、環境構築などを行う過程でPCの設定ファイルや環境変数に誤った手を加え、元に戻せない等の場合もあります。その場合はPCを初期化することで解決できる可能性があるので、検討してみてください。